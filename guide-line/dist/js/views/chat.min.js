jQuery.inc("components.chat"),jQuery.inc("models.chat"),jQuery.inc("vendors.bootstrap.jasny"),jQuery.inc("vendors.socket.io"),jQuery.inc("vendors.tweenmax"),jQuery.clss("views.chat",{SERVER_URL:"192.168.1.3:7205",uses:[],validateOptions:{loginForm:{rules:{avatar:{required:!0,accept:"image/jpeg, image/pjpeg"},username:"required"}}},chat:null,loginForm:$("#loginForm"),loginContainer:$("#login"),messages:$("#messages"),tweetForm:$("#tweetForm"),textaForm:$("#tweetForm textarea"),_constructor:function(){$.views.chat.init()},init:function(){this.chat=new Chat({socket:io(this.SERVER_URL),onConnect:this.chatOnConnect.bind(this),onDisconnect:this.chatOnDisconnect.bind(this)}),TweenMax.set("#tweets",{y:"+=100%"}),TweenMax.set("#login",{y:"-=200%"}),this._uses(),this._validate(),this._bindData(),this._bindEvents()},_bindData:function(){ko.applyBindings(this.chat.model.viewModel,this.loginContainer.get(0)),ko.applyBindings(this.chat.model.viewModel,this.messages.get(0))},_bindEvents:function(){this.loginForm.on("submit",this.loginFormOnSubmit.bind(this)),this.tweetForm.on("submit",this.tweetFormOnSubmit.bind(this)),this.textaForm.on("keydown",this.textaFormOnKeyDown.bind(this))},_uses:function(){this.parent._uses(this.uses)},_validate:function(){this.loginForm.validate(this.validateOptions.loginForm)},addUser:function(a,b){this.chat.addUser(a,b)},message:function(a){this.chat.send(a,function(){console.log("Enviado")}),this.chat.model.addMessage({username:this.chat.model.getUser().username,message:a})},chatOnConnect:function(){console.log("view.chat: onConnect!"),TweenMax.to("#login",2,{y:"+=150%",ease:Elastic.easeOut.config(1,.75)})},chatOnDisconnect:function(){console.log("view.chat: onDisconnect!")},loginFormOnSubmit:function(a){return a.preventDefault(),this.loginForm.valid()&&this.addUser(this.chat.model.getUser(),function(){TweenMax.to("#login",2,{y:"-=200%",ease:Elastic.easeInOut.config(1,.75)}),TweenMax.to("#tweets",1,{y:"-=100%",delay:2})}),!1},tweetFormOnSubmit:function(a){var b=$(a.target).serializeArray()[0].value;return a.preventDefault(),b&&this.message(b),a.target.reset(),!1},textaFormOnKeyDown:function(a){return a=a||event,13!=a.keyCode||a.shiftKey?void 0:(a.preventDefault(),this.tweetForm.submit(),!1)}})();